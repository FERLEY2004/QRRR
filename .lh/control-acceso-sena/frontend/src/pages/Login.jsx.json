{
    "sourceFile": "control-acceso-sena/frontend/src/pages/Login.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1764100813865,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1764102796067,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,9 +1,8 @@\n // Login Page\n import React, { useState } from 'react';\n import { useNavigate, useLocation } from 'react-router-dom';\n import { useAuth } from '../context/AuthContext';\n-import logo from '../photos/Huella.png';\n \n const Login = () => {\n   const [email, setEmail] = useState('');\n   const [password, setPassword] = useState('');\n@@ -59,11 +58,8 @@\n   return (\n     <div className=\"min-h-screen bg-gradient-to-br from-blue-900 via-blue-800 to-blue-700 flex items-center justify-center p-4\">\n       <div className=\"bg-white rounded-2xl shadow-2xl w-full max-w-md p-8\">\n         <div className=\"text-center mb-8\">\n-          <div className=\"flex justify-center mb-4\">\n-            <img src={logo} alt=\"Logo SENA\" className=\"h-20 w-20 object-contain\" />\n-          </div>\n           <h1 className=\"text-3xl font-bold text-gray-800\">Control de Acceso SENA</h1>\n           <p className=\"text-gray-600 mt-2\">Inicia sesión para continuar</p>\n         </div>\n \n"
                },
                {
                    "date": 1764318401968,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,9 @@\n // Login Page\n import React, { useState } from 'react';\n import { useNavigate, useLocation } from 'react-router-dom';\n import { useAuth } from '../context/AuthContext';\n+import logo from '../photos/Huella.png';\n \n const Login = () => {\n   const [email, setEmail] = useState('');\n   const [password, setPassword] = useState('');\n@@ -58,8 +59,9 @@\n   return (\n     <div className=\"min-h-screen bg-gradient-to-br from-blue-900 via-blue-800 to-blue-700 flex items-center justify-center p-4\">\n       <div className=\"bg-white rounded-2xl shadow-2xl w-full max-w-md p-8\">\n         <div className=\"text-center mb-8\">\n+          <img src={logo} alt=\"Control de Acceso SENA\" className=\"mx-auto h-24 w-24 mb-4\" />\n           <h1 className=\"text-3xl font-bold text-gray-800\">Control de Acceso SENA</h1>\n           <p className=\"text-gray-600 mt-2\">Inicia sesión para continuar</p>\n         </div>\n \n"
                },
                {
                    "date": 1764319303287,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,9 +1,9 @@\n // Login Page\n import React, { useState } from 'react';\n import { useNavigate, useLocation } from 'react-router-dom';\n import { useAuth } from '../context/AuthContext';\n-import logo from '../photos/Huella.png';\n+import logo from '../photos/huella1.png';\n \n const Login = () => {\n   const [email, setEmail] = useState('');\n   const [password, setPassword] = useState('');\n"
                }
            ],
            "date": 1764100813865,
            "name": "Commit-0",
            "content": "// Login Page\nimport React, { useState } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { useAuth } from '../context/AuthContext';\nimport logo from '../photos/Huella.png';\n\nconst Login = () => {\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [error, setError] = useState('');\n  const [loading, setLoading] = useState(false);\n  const { login } = useAuth();\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setError('');\n    setLoading(true);\n\n    try {\n      await login(email, password);\n      // Redirigir a la página desde donde venía el usuario, o según el rol\n      const from = location.state?.from?.pathname;\n      const userRole = localStorage.getItem('userRole');\n      const normalizedRole = userRole ? userRole.toUpperCase() : '';\n      \n      if (from) {\n        navigate(from, { replace: true });\n      } else if (normalizedRole === 'ADMIN' || normalizedRole === 'ADMINISTRADOR') {\n        navigate('/admin', { replace: true });\n      } else {\n        navigate('/scanner', { replace: true });\n      }\n    } catch (err) {\n      // Mejorar el manejo de errores para mostrar mensajes más claros\n      let errorMessage = 'Error al iniciar sesión';\n      \n      if (err.response) {\n        // Error del servidor (401, 500, etc.)\n        errorMessage = err.response.data?.message || `Error ${err.response.status}: ${err.response.statusText}`;\n        if (err.response.data?.hint) {\n          errorMessage += ` - ${err.response.data.hint}`;\n        }\n      } else if (err.request) {\n        // El servidor no respondió\n        errorMessage = 'No se puede conectar al servidor. Verifica que el backend esté corriendo en http://localhost:4000';\n      } else if (err.message) {\n        errorMessage = err.message;\n      }\n      \n      setError(errorMessage);\n      console.error('Error en login:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-900 via-blue-800 to-blue-700 flex items-center justify-center p-4\">\n      <div className=\"bg-white rounded-2xl shadow-2xl w-full max-w-md p-8\">\n        <div className=\"text-center mb-8\">\n          <div className=\"flex justify-center mb-4\">\n            <img src={logo} alt=\"Logo SENA\" className=\"h-20 w-20 object-contain\" />\n          </div>\n          <h1 className=\"text-3xl font-bold text-gray-800\">Control de Acceso SENA</h1>\n          <p className=\"text-gray-600 mt-2\">Inicia sesión para continuar</p>\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"space-y-6\">\n          {error && (\n            <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg\">\n              {error}\n            </div>\n          )}\n\n          <div>\n            <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Email\n            </label>\n            <input\n              id=\"email\"\n              type=\"email\"\n              value={email}\n              onChange={(e) => setEmail(e.target.value)}\n              required\n              className=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition\"\n              placeholder=\"admin@sena.edu.co\"\n            />\n          </div>\n\n          <div>\n            <label htmlFor=\"password\" className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Contraseña\n            </label>\n            <input\n              id=\"password\"\n              type=\"password\"\n              value={password}\n              onChange={(e) => setPassword(e.target.value)}\n              required\n              className=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition\"\n              placeholder=\"••••••••\"\n            />\n          </div>\n\n          <button\n            type=\"submit\"\n            disabled={loading}\n            className=\"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center\"\n          >\n            {loading ? (\n              <>\n                <svg className=\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n                  <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                  <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                </svg>\n                Iniciando sesión...\n              </>\n            ) : (\n              'Iniciar Sesión'\n            )}\n          </button>\n        </form>\n\n        <div className=\"mt-6 text-center text-sm text-gray-600\">\n          <p>Credenciales por defecto:</p>\n          <p className=\"mt-2\">\n            <span className=\"font-semibold\">Admin:</span> admin@sena.edu.co / admin123<br />\n            <span className=\"font-semibold\">Guarda:</span> guarda@sena.edu.co / guarda123\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Login;\n"
        }
    ]
}